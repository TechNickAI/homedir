# This file contains code that is for both OSX and Linux

# Python and virtual env
PYTHONPYCACHEPREFIX=$HOME/.cache/python

# virtualenvwrapper setup - try pipx first, fall back to dynamic search
VIRTUAL_ENV_WRAPPER_PATH="$HOME/.local/bin/virtualenvwrapper.sh"

# Fall back to dynamic search if not found
if [ ! -f "$VIRTUAL_ENV_WRAPPER_PATH" ]; then
    VIRTUAL_ENV_WRAPPER_PATH=$(command -v virtualenvwrapper.sh 2>/dev/null)
fi

if [ -f "$VIRTUAL_ENV_WRAPPER_PATH" ]; then
    # If using pipx installation, use its Python
    if [[ "$VIRTUAL_ENV_WRAPPER_PATH" == "$HOME/.local/bin/virtualenvwrapper.sh" ]]; then
        export VIRTUALENVWRAPPER_PYTHON="$HOME/.local/pipx/venvs/virtualenvwrapper/bin/python"
    else
        # Dynamic fallback for other installations
        export VIRTUALENVWRAPPER_PYTHON=$(command -v python3)
    fi

    export WORKON_HOME="$HOME/.virtualenvs"
    source "$VIRTUAL_ENV_WRAPPER_PATH"
fi

# Turn on better_exceptions in python
# https://github.com/Qix-/better-exceptions
export BETTER_EXCEPTIONS=1

#### Environment variables
# Always use vim
export SVN_EDITOR=$(which vim)
export EDITOR=$(which vim)

function randpasswd() {
    pwgen -y $1
}
